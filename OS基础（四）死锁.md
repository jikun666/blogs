死锁是指多个进程/线程/协程在运行过程中因争夺资源而造成的一种僵持状态。

---
在 golang 程序里面，无法在编译阶段识别死锁，只能在运行时发现，一旦发现死锁，就会 panic deadlock

---


产生死锁的 4 个必要条件：

- 互斥条件：资源具有排它性，即在一段时间内某资源仅为一进程所占用。
- 请求和保持条件：当进程因请求资源而阻塞时，对已获得的资源保持不放。
- 占有不剥夺条件：进程已获得的资源在未使用完之前，不能剥夺，只能在使用完时由自己释放。
- 环路等待条件：在发生死锁时，必然存在一个进程--资源的环形链。


可以针对以上 4 个条件进行预防死锁。只要打破一个条件死锁就不成立了。

- 资源一次性分配：一次性分配所有资源，这样就不会再有请求了：（破坏请求条件）
- 只要有一个资源得不到分配，也不给这个进程分配其他的资源：（破坏请求和保持条件）
- 可剥夺资源：即当某进程获得了部分资源，但得不到其它资源，则释放已占有的资源（破坏不可剥夺条件）
- 资源有序分配法：系统给每类资源赋予一个编号，每一个进程按编号递增的顺序请求资源，释放则相反（破坏环路等待条件）
