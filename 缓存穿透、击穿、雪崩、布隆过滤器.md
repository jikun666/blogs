# 穿透

缓存穿透指数据库中没有的数据，而用户不断发起请求，此时缓存失效，并且大量的请求都落到数据库，导致数据库瘫痪。

可以将 key-null 对写入缓存（注意设置过期时间），同时在前端捕捉攻击者特征进行拦截。


# 击穿

缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力。


当缓存数据失效时，获取分布式锁。如果获取锁成功，从数据库取数据放入缓存，然后解开锁；如果获取锁失败，则等待100ms再重新从缓存获取数据。

# 雪崩

缓存中数据大批量到过期时间，而查询数据量巨大，引起数据库压力过大甚至宕机。

和缓存击穿不同的是，击穿指并发查同一条数据，雪崩是不同数据都过期了，很多数据都查不到从而查数据库。

缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。


# 布隆过滤器

本质上布隆过滤器是一种数据结构，可以用来告诉你 “**某样东西一定不存在或者可能存在**”。

相比于传统的 List、Set、Map 等数据结构，它更高效、占用空间更少，但是缺点是其返回的结果是概率性的，而不是确切的。


https://zhuanlan.zhihu.com/p/43263751


如何选择布隆过滤器长度和哈希函数个数?

很显然，过小的布隆过滤器很快所有的 bit 位均为 1，那么查询任何值都会返回“可能存在”，起不到过滤的目的了。布隆过滤器的长度会直接影响误报率，布隆过滤器越长其误报率越小。

另外，哈希函数的个数也需要权衡，个数越多则布隆过滤器 bit 位置位 1 的速度越快，且布隆过滤器的效率越低；但是如果太少的话，那我们的误报率会变高。